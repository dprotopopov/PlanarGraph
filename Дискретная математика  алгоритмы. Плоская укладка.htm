<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0073)http://rain.ifmo.ru/cat/view.php/theory/graph-coloring-layout/layout-2004 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1251">

<title>Дискретная математика: алгоритмы. Плоская укладка</title>
<link rel="stylesheet" href="./Дискретная математика  алгоритмы. Плоская укладка_files/styles.css" type="text/css">
<link rel="alternate" type="application/atom+xml" title="Новости сайта CAT" href="http://rain.ifmo.ru/cat/atom.php">
<meta name="keywords" content="структура данных,алгоритм,программирование,визуализатор алгоритма,граф,сортировка,data structure,algorithm,programming,algorithm visualizer,graph,sorting">
</head>
<body>

<table id="head" cellspacing="0">
<tbody><tr>
<td id="logo"><a href="http://rain.ifmo.ru/cat/view.php/"><img src="./Дискретная математика  алгоритмы. Плоская укладка_files/cat.gif" width="130" height="130" alt="Computer Algorithm Tutor"></a></td>
<td>
<div id="title-line-1">
САНКТ-ПЕТЕРБУРГСКИЙ ГОСУДАРСТВЕННЫЙ УНИВЕРСИТЕТ<br>
ИНФОРМАЦИОННЫХ ТЕХНОЛОГИЙ, МЕХАНИКИ И ОПТИКИ
</div>
<div id="title-line-2">
ФАКУЛЬТЕТ ИНФОРМАЦИОННЫХ ТЕХНОЛОГИЙ И ПРОГРАММИРОВАНИЯ<br>
КАФЕДРА КОМПЬЮТЕРНЫХ ТЕХНОЛОГИЙ
</div>
<div id="title-line-3">
ДИСКРЕТНАЯ МАТЕМАТИКА: АЛГОРИТМЫ
</div>
</td>
<td align="right">
<!-- E-mail кодируется для предотвращения спама. Не пугайтесь. -->
<script type="text/javascript" src="./Дискретная математика  алгоритмы. Плоская укладка_files/orphus.js"></script>
<a href="http://orphus.ru/" id="orphus" target="_blank" title="Orphus"><img alt="Orphus" src="./Дискретная математика  алгоритмы. Плоская укладка_files/orphus.gif" border="0"></a>
</td>
</tr>
</tbody></table>

<div id="path">
<a href="http://rain.ifmo.ru/cat/view.php/">Первая страница</a> /
<a href="http://rain.ifmo.ru/cat/view.php/theory">Теория</a> /
<a href="http://rain.ifmo.ru/cat/view.php/theory/graph-coloring-layout">Графы. Раскраски и укладки</a> /
<h1>Плоская укладка</h1>
</div>

<table id="body" cellspacing="0">
<tbody><tr>
<td id="menu">
<a href="http://rain.ifmo.ru/cat/view.php/news">Новости</a>
<a href="http://rain.ifmo.ru/cat/view.php/theory" class="pressed">Теория</a>
<a href="http://rain.ifmo.ru/cat/view.php/vis">Визуализаторы</a>
<a href="http://rain.ifmo.ru/cat/view.php/books">Что почитать</a>
<a href="http://rain.ifmo.ru/cat/view.php/links">Ссылки</a>
<a href="http://rain.ifmo.ru/cat/view.php/aboutus">О нас</a>
<div class="separator">&nbsp;</div>
<a href="http://rain.ifmo.ru/cat/search.php">Поиск по сайту</a>
<div class="separator">&nbsp;</div>
<a href="http://rain.ifmo.ru/cat/view.php/contributors">Авторам</a>
<a href="http://rain.ifmo.ru/cat/view.php/feedback">Обратная связь</a>
<div class="separator">&nbsp;</div>
<a href="http://rain.ifmo.ru/cat/view.php/students">Студентам КТ</a>
<div class="separator">&nbsp;</div>

<!-- HotLog -->
<script type="text/javascript">
hotlog_r=""+Math.random()+"&amp;s=186237&amp;im=134&amp;r="+
escape(document.referrer)+"&amp;pg="+escape(window.location.href);
hotlog_r+="&amp;j="+(navigator.javaEnabled()?"Y":"N");
hotlog_r+="&amp;wh="+screen.width+"x"+screen.height+"&amp;px="+
(((navigator.appName.substring(0,3)=="Mic"))?screen.colorDepth:screen.pixelDepth);
hotlog_r+="&amp;js=1.3";
document.write('<a href="http://click.hotlog.ru/?186237" target="_blank"><img '+
'src="http://hit8.hotlog.ru/cgi-bin/hotlog/count?'+
hotlog_r+'" border="0" width="88" height="31" alt="HotLog"><\/a>');
</script><a href="http://click.hotlog.ru/?186237" target="_blank"><img src="./Дискретная математика  алгоритмы. Плоская укладка_files/count" border="0" width="88" height="31" alt="HotLog"></a>
<noscript>
&lt;a href="http://click.hotlog.ru/?186237" target="_blank"&gt;&lt;img
src="http://hit8.hotlog.ru/cgi-bin/hotlog/count?s=186237&amp;amp;im=134" border="0"
width="88" height="31" alt="HotLog"&gt;&lt;/a&gt;
</noscript>
<!-- /HotLog -->

<div class="separator">&nbsp;</div>

<!-- Concours "IT-education in Runet" banner -->
<a href="http://www.ict.edu.ru/konkurs/" target="_blank" class="plain">
<img src="./Дискретная математика  алгоритмы. Плоская укладка_files/laureat100x100.gif" width="100" height="100" alt="IT-образование в Рунете 2005"></a>
<!-- End of concours "IT-education in Runet" banner -->

<div class="separator">&nbsp;</div>
<a href="http://www.inforum.spb.ru/contest/champ-2004.asp" target="_blank" class="plain"><img src="./Дискретная математика  алгоритмы. Плоская укладка_files/nwforum.gif" width="100" height="75" alt="Победители конкурса сайтов Северо-Западного Интернет-форума 2004"></a>

</td>
<td id="content">

<form id="votes" action="http://rain.ifmo.ru/cat/vote.php/theory/graph-coloring-layout/layout-2004/" method="post">
Голосование:
<input type="image" name="vote" value="pro" src="./Дискретная математика  алгоритмы. Плоская укладка_files/vote_pro.gif" alt="За "> 14,
<input type="image" name="vote" value="con" src="./Дискретная математика  алгоритмы. Плоская укладка_files/vote_con.gif" alt="Против"> 8</form>

<p>
    В данной статье будет рассмотрена задача на графах о возможности
    нарисовать тот или иной граф без самопересечений. То есть нарисовать граф
    так, чтобы его ребра не имели общих внутренних точек. Поставленную задачу
    принято называть <dfn>задачей о плоской укладке графа</dfn>.
</p>
<p>
    Область применения результата, который мы получим, очень обширна. Одна
    из них&nbsp;— это изготовление электронных схем. Электрические цепи
    печатным способом наносятся на плату из изолирующего материала. Так как
    наносимые цепи не изолированы, то они не должны пересекаться. Отсюда
    вытекает вопрос, как расположить контакты на схеме, чтобы можно было без
    пересечений нанести цепи на плату. А если так сделать нельзя, то каким
    минимальным числом плат (<em>слоев</em> графа) можно обойтись.
</p>
<p>
    Мы коснемся только первой части вопроса и ответим, когда и как можно
    нарисовать граф без самопересечений.
</p>


<h2>Основные определения</h2>

<p> 
    <dfn>Плоский граф</dfn>&nbsp;— это граф, нарисованный таким образом,
    что его ребра не пересекаются. Говорят, что граф <dfn>допускает плоскую
    укладку</dfn>, если его можно нарисовать как плоский. Также плоские графы
    называют <dfn>планарными</dfn>.
</p>
<ul>
<li>
    <p>Граф, изображенный на рис.&nbsp;1, плоский:</p>
    <img src="./Дискретная математика  алгоритмы. Плоская укладка_files/examp_01.gif" width="200" height="150" alt="Рис. 1. Плоский граф">
</li>
<li>
<p>
    Существуют и непланарные графы. На рис.&nbsp;2 показаны два таких графа:
    полный пятивершинник и полный двудольный граф. Для них есть специальные
    обозначения: K<sub>5</sub> и K<sub>3,3</sub> соответственно.
</p>
<img src="./Дискретная математика  алгоритмы. Плоская укладка_files/examp_02.gif" width="400" height="150" alt="Рис. 2. Примеры непланарных графов">
</li>
</ul>
<p>
    <dfn>Двудольный граф</dfn>&nbsp;— это граф, вершины которого разбиты
    на две доли (части), а ребра проходят только между вершинами из разных
    частей.
</p>
<p>
    В планарном графе можно говорить не только о вершинах и ребрах, но и
    о гранях.
</p>
<p>
    <dfn>Грань</dfn>&nbsp;— это часть плоскости, окруженная простым
    циклом и не содержащая внутри себя других элементов графа.
</p>
<p>
    <dfn>Внешняя грань</dfn>&nbsp;— это вся плоскость, окружающая
    плоский граф.
</p>


<h2>Задача о плоской укладке</h2>

<p>
    <strong>Задача.</strong> Определить, является ли граф планарным, и, если
    да, то произвести его плоскую укладку.
</p>
<p>
    <strong>Замечание.</strong> Если на ребра планарного графа нанести
    произвольное число вершин степени 2, то он останется планарным; равным
    образом, если на ребра непланарного графа нанести вершины степени 2, то он
    планарным не станет.
</p>
<p>
    В конце 1920-х годов Куратовский в Польше и Л.С.&nbsp;Понтрягин в СССР
    независимо доказали поразительную теорему, показывающую, что мешает графу
    быть планарным.
</p>

<h3>Теорема (Понтрягин-Куратовский)</h3>

<p>
    Граф планарен тогда и только тогда, когда он не содержит в качестве частей
    графы К<sub>5</sub> и К<sub>3,3</sub> (быть может с добавочными вершинами
    степени 2).
</p>
<p>
    Мы опустим достаточно сложное доказательство этой теоремы.
    Заинтересованный читатель сможет найти его в [2]. Однако не следует
    думать, что раз трудностей всего две, то непланарных графов мало: при
    росте числа вершин непланарны почти все графы.
</p>
<p>
    Рассмотренный критерий очень трудоемок для проверки и поэтому представляет
    лишь теоретический интерес.
</p>


<h2>Гамма-алгоритм</h2>

<p>
    Для плоской укладки графа и попутной проверки, планарен ли он, удобно
    пользоваться <dfn>гамма-алгоритмом</dfn>.
</p>
<p>На вход подаются графы, обладающие следующими свойствами:</p>
<ol>
<li>граф связный;</li>
<li>граф имеет хотя бы один цикл;</li>
<li>
    граф не имеет мостиков, т.&nbsp;е. ребер, после удаления которых
    граф распадается на две компонеты связности.
</li>
</ol>
<p>
    Если нарушено свойство (1), то граф нужно укладывать отдельно
    по компонентам связности.
</p>
<p>
    Если нарушено свойство (2), то граф&nbsp;— дерево и нарисовать его
    плоскую укладку тривиально.
</p>

<p>
    Случай нарушения свойства (3) рассмотрим  более подробно. Если в графе
    есть мостики, то их нужно разрезать, провести отдельно плоскую укладку
    каждой компоненты связности, а затем соединить их мостиками. Здесь может
    возникнуть трудность: в процессе укладки концевые вершины мостика могут
    спрятаться внутри плоского графа. Нарисуем одну компоненту связности
    и будем присоединять к ней другие последовательно. Каждую новую компоненту
    связности будем рисовать в той грани, в которой лежит концевая вершина
    соответствующего мостика. Так как граф связности мостиками компонент
    связности является деревом, мы сумеем получить плоскую укладку.
</p>
<p>
    Сначала изложим алгоритм на конкретном примере. Пусть дан граф <var>G</var>
    (см.&nbsp;рис.&nbsp;3).
</p>
<img src="./Дискретная математика  алгоритмы. Плоская укладка_files/examp_03.gif" width="250" height="150" alt="Рис. 3">
<p>
    Инициализация алгоритма производится так: выбираем любой простой цикл;
    в нашем примере
    {1,&nbsp;2,&nbsp;3,&nbsp;4,&nbsp;5,&nbsp;6,&nbsp;7,&nbsp;8} и получаем две
    грани: &#915;<sub>1</sub>&nbsp;— внешнюю
    и &#915;<sub>2</sub>&nbsp;— внутреннюю (см.&nbsp;рис.&nbsp;4).
</p>
<img src="./Дискретная математика  алгоритмы. Плоская укладка_files/examp_04.gif" width="250" height="150" alt="Рис. 4">
<!-- NEW begin -->
<p>
    Обозначим выбранный цикл как <var>G</var>&#8242;. На каждом шаге будем
    строить множество <em>сегментов</em>. Каждый сегмент <var>S</var>
    относительно уже построенного графа <var>G</var>&#8242; представляет
    собой одно из двух:
</p>
<ul>
<li>
    ребро, оба конца которого принадлежат <var>G</var>&#8242;, но само оно
    не принадлежит <var>G</var>&#8242;;
</li>
<li>
    связную компоненту графа <var>G</var>&nbsp;–&nbsp;<var>G</var>&#8242;,
    дополненную всеми ребрами графа <var>G</var>, один из концов которых
    принадлежит связной компоненте, а второй из графа <var>G</var>&#8242;.
</li>
</ul>
<p>
    Те вершины, которые одновременно принадлежат <var>G</var>&#8242;
    и какому-то сегменту, назовем <em>контактными</em>. Для нашего примера
    сегменты и вершины изображены на рис.&nbsp;5. Контактные вершины
    обведены в квадрат.
</p>
<!-- NEW end -->    
<img src="./Дискретная математика  алгоритмы. Плоская укладка_files/examp_05.gif" width="250" height="150" alt="Рис. 5">
<p>
    Если бы в каком-нибудь сегменте не было ни одной контактной вершины,
    то граф до разрезания был бы несвязный; если бы была только одна, то граф
    имел бы мостик. Эти возможности заранее исключены, так что каждый сегмент
    имеет не менее двух контактных вершин. Поэтому в каждом сегменте имеется
    цепь между любой парой таких вершин.
</p>
<p>
    Если все контактные вершины сегмента <var>S</var> имеют номера вершин
    какой-то грани &#915;, то мы будем говорить, что грань &#915;
    <em>вмещает</em> этот сегмент и обозначать <var>S</var>&#8834;&#915;. Может
    быть имеется не одна такая грань, вмещающая сегмент <var>S</var>,
    множество таких граней обозначим &#915;(<var>S</var>), а их число
    |&#915;(<var>S</var>)|.
</p>
<p>
    Общий шаг алгоритма следующий: обозреваются все сегменты
    <var>S<sub>i</sub></var> и определяются числа
    |&#915;(<var>S<sub>i</sub></var>)|. Если хоть одно из них равно 0, то
    граф не планарен, конец. Иначе, выбираем сегмент, для которого число
    |&#915;(<var>S</var>)| минимально, или один из множества, если таких
    сегментов несколько. В этом сегменте найдем цепь между двумя контактными
    вершинами и уложим ее в любую из граней множества &#915;(<var>S</var>),
    совместив контактные вершины сегмента с соответствующими вершинами грани.
    При этом данная грань разобьется на две. Уже уложенная часть графа
    <var>G</var>&#8242; по количеству ребер и вершин увеличится, а сегмент,
    из которого вынута цепь, исчезнет или развалится на меньшие с новыми
    контактными вершинами, ведущими к вершинам <var>G</var>&#8242;.
</p>
<p>
    В результате повторения общего шага либо будет получена плоская укладка,
    когда множество сегментов станет пустым, либо будет получено, что граф
    <var>G</var> не является планарным.
</p>
<p>
    Вернемся к нашему примеру. Пока для любого <var>i</var>:
    <var>S<sub>i</sub></var>&#8834;{&#915;<sub>1</sub>,&nbsp;&#915;<sub>2</sub>},
    |&#915;(<var>S<sub>i</sub></var>)|&nbsp;=&nbsp;2. Поэтому возьмем первый
    по номеру сегмент <var>S<sub>i</sub></var> и в нем первую попавшеюся цепь
    {4,&nbsp;8}; вставим эту цепь в грань &#915;<sub>2</sub>. Получим
    увеличенную часть <var>G</var>&#8242; и уменьшенную систему сегментов
    (см.&nbsp;рис.&nbsp;6&nbsp;a,&nbsp;b).
</p>
<img src="./Дискретная математика  алгоритмы. Плоская укладка_files/examp_06.gif" width="400" height="150" alt="Рис. 6">
<!-- NEW begin -->
<p>
    Определим какие грани вмещают новые сегменты. Теперь сегменты 
    <var>S</var><sub>1</sub> и <var>S</var><sub>2</sub> вмещаются 
    только в одну грань &#915;<sub>1</sub>, в то время, как сегмент  
    <var>S</var><sub>3</sub> вмещается в две грани &#915;<sub>1</sub> и 
    &#915;<sub>3</sub>. Поэтому берем <var>S</var><sub>1</sub>. 
    Возьмем в нем цепь между контактными вершинами, например, {2,&nbsp;7},
    и уложим ее в &#915;<sub>1</sub>. Получим увеличенную часть <var>G</var>&#8242; 
    и уменьшенную систему сегментов (см.&nbsp;рис.&nbsp;7&nbsp;a,&nbsp;b). 
</p>
<!-- NEW end -->
<img src="./Дискретная математика  алгоритмы. Плоская укладка_files/examp_07.gif" width="400" height="150" alt="Рис. 7">
<p>
    Продолжая таким образом, в итоге получим плоскую укладку <var>G</var>
    (см.&nbsp;рис.&nbsp;8).
</p>
<img src="./Дискретная математика  алгоритмы. Плоская укладка_files/examp_08.gif" width="300" height="150" alt="Рис. 8">
<p>Еще раз опишем гамма-алгоритм компактно и займемся его обоснованием.</p>

<p><strong>Гамма-алгоритм</strong></p>
<ol>
<li>
    (Инициализация). Выберем любой простой цикл <var>C</var> исходного графа
    <var>G</var>; изобразим его на плоскости в виде грани, которую примем
    за уже уложенную часть <var>G</var>&#8242;; сформируем сегменты
    <var>S<sub>i</sub></var>; если множество сегментов пусто, то перейти
    к п.&nbsp;3.
</li>
<li>
    (Общий шаг). Пока множество сегментов непусто:
    <ol type="a">
    <li>
        Для каждого сегмента <var>S</var> найти множество
        &#915;(<var>S</var>). Если существует сегмент <var>S</var>, для
        которого |&#915;(<var>S</var>)|&nbsp;=&nbsp;0, то граф не планарный,
        конец.
    </li>
    <li>
        Выбираем один из сегментов с минимальным числом, вмещающих его граней.
    </li>
    <li>Выбираем одну из подходящих граней для выбранного сегмента.</li>
    <li>
        В данном сегменте выбираем цепь между двумя контактными вершинами
        и укладываем ее в выбранной грани. Учтем изменения в структуре
        сегментов и перейдем к п.&nbsp;a).
    </li>
    </ol>
</li>
<li>
    (Завершение). Построена плоская укладка <var>G</var>&#8242; исходного
    графа <var>G</var>, конец.
</li>
</ol>


<h2>Корректность гамма-алгоритма</h2>

<p>Вначале докажем ряд впомогательных утверждений.</p>

<h3>Лемма 1</h3>

<p>Для любого сегмента |&#915;(<var>S</var>)|&nbsp;&#8804;&nbsp;2.</p>
<p>
    <strong>Доказательство.</strong>
    Действительно, если все контактные вершины одного сегмента принадлежат
    некоторой грани &#915; (точнее, циклу, окружающему эту грань), то они
    могут принадлежать все вместе только одной еще грани, а именно внутренней
    или внешней. Ч.&nbsp;т.&nbsp;д.
</p>

<p>
    Назовем сегменты <var>S</var><sub>1</sub> и <var>S</var><sub>2</sub>
    <dfn>конфликтующими относительно уже уложенной части</dfn>, если:
</p>
<ul>
<li>существует грань, которая вмещает каждый из сегментов;</li>
<li>
    в сегментах <var>S</var><sub>1</sub> и <var>S</var><sub>2</sub> есть две
    цепи (между контактными вершинами) <var>L</var><sub>1</sub>
    и <var>L</var><sub>2</sub> соответственно, такие, что их невозможно
    уложить в одну грань без пересечения.
</li>
</ul>

<h3>Лемма 2</h3>

<p>
    Конфликтующие сегменты <var>S</var><sub>1</sub> и <var>S</var><sub>2</sub>
    обладают следующим свойством: если
    |&#915;(<var>S</var><sub>1</sub>)|&nbsp;=&nbsp;2 и
    |&#915;(<var>S</var><sub>2</sub>)|&nbsp;=&nbsp;2, то
    &#915;(<var>S</var><sub>1</sub>)&nbsp;=&nbsp;&#915;(<var>S</var><sub>2</sub>).
</p>
<p>
    <strong>Доказательство.</strong>
    Действительно, в противном случае, имея по определению одну общую
    вмещающую грань &#915;<sub>3</sub>, они бы имели еще по собственной
    вмещающей грани &#915;<sub>1</sub> и &#915;<sub>2</sub> соответственно.
    Тогда любые цепи из <var>S</var><sub>1</sub> и <var>S</var><sub>2</sub>
    могли бы разместиться в &#915;<sub>1</sub> и &#915;<sub>2</sub>
    соответственно, а значит и в &#915;<sub>3</sub>, причем без пересечения;
    следовательно <var>S</var><sub>1</sub> и <var>S</var><sub>2</sub> не были
    бы конфликтующими. Противоречие. Лемма доказана.
</p>
<p>
    <strong>Замечание.</strong>
    Из доказанной леммы следует, что, имея сегмент <var>S</var><sub>1</sub>,
    и еще сегмент <var>S</var><sub>2</sub>, конфликтующий
    с <var>S</var><sub>1</sub>, затем сегмент <var>S</var><sub>3</sub>,
    конфликтующий с <var>S</var><sub>2</sub> (но не
    с <var>S</var><sub>1</sub>) и т.&nbsp;д., причем каждый вмещается в две
    грани, то эти грани общие для всех сегментов последовательности, и можно
    размещать цепь <var>L</var><sub>1</sub> из <var>S</var><sub>1</sub>
    в первую грань &#915;<sub>1</sub>, <var>L</var><sub>2</sub>
    из <var>S</var><sub>2</sub> в &#915;<sub>2</sub>,
    <var>L</var><sub>3</sub> из <var>S</var><sub>3</sub> снова
    в &#915;<sub>1</sub> и т.&nbsp;д. до конца последовательности. Если
    цепочка сегментов замыкается в цикл четной длины, то проблем не будет;
    если в нечетный цикл, то в конце окажется, что два конфликтующих сегмента
    нужно разместить без пересечений в общую грань, что невозможно.
</p>
<p>
    Сейчас нам понадобится в качестве вспомагательного утверждения теорема
    Кенига, которая полезна при решении и многих других задач.
</p>

<h3>Теорема (Кениг)</h3>

<p>
    В графе все циклы четные тогда и только тогда, когда граф является
    двудольным.
</p>
<p><strong>Доказательство.</strong></p>
<p>
    <strong>Достаточность.</strong>
    Рассмотрим двудольный граф. Начнем цикл в верхней доли. Нужно пройти
    по четному числу ребер, чтобы подняться снова в верхнюю долю.
    Следовательно, при замыкании цикла число ребер будет четным.
</p>
<p>
    <strong>Необходимость.</strong>
    Если граф несвязный, то проведем доказательство отдельно для каждой
    компоненты. Пусть граф связный и все циклы в нем четные. Выделим
    произвольную вершину <var>v</var><sub>0</sub> и найдем произвольные цепи
    между <var>v</var><sub>0</sub> и всеми остальными вершинами (например,
    самые короткие алгоритмом Дейкстры). Если одна цепь
    (<var>v</var><sub>0</sub>,&nbsp;<var>v<sub>i</sub></var>) нечетной длины,
    то и любая цепь (<var>v</var><sub>0</sub>,&nbsp;<var>v<sub>i</sub></var>)
    нечетная, иначе бы эти цепи образовали нечетный цикл. Аналогично, если
    (<var>v</var><sub>0</sub>,&nbsp;<var>v<sub>i</sub></var>)&nbsp;—
    четная, то и любая
    (<var>v</var><sub>0</sub>,&nbsp;<var>v<sub>i</sub></var>)&nbsp;—
    четная. Разобьем вершины на две доли: в одну войдет вершина
    <var>v</var><sub>0</sub> и все, находящиеся от <var>v</var><sub>0</sub>
    на четном расстоянии; в другую долю поместим все вершины, находящиеся
    от <var>v</var><sub>0</sub> на нечетном расстоянии. Если вершины
    <var>u</var><sub>1</sub> и <var>u</var><sub>2</sub> принадлежат одной
    доле, то между ними не может быть ребра, иначе это ребро вместе с цепями
    (<var>v</var><sub>0</sub>,&nbsp;<var>u</var><sub>1</sub>)
    и (<var>v</var><sub>0</sub>,&nbsp;<var>u</var><sub>2</sub>) образовали
    бы нечетный цикл. Ч.&nbsp;т.&nbsp;д.
</p>
<p>
    <dfn>Частичной укладкой</dfn> <var>G</var>&#8242; планарного графа
    <var>G</var> называется граф, который можно получить из какой-нибудь
    укладки графа <var>G</var> на плоскости удалением каких-то ребер и вершин.
    Таким образом, частичная укладка&nbsp;— это правильное начало
    укладки, в ней еще не сделано ошибок.
</p>
<p>
    В частичной укладке <var>G</var>&#8242; сопоставим каждому сегменту
    вершину в некотором постороннем служебном графе
    <var>A</var>(<var>G</var>&#8242;), где вершины соединяются ребрами, если
    соответствующие сегменты являются конфликтующими.
</p>


<h3>Лемма 3</h3>

<p>
    Если результатом некоторого шага работы гамма-алгоритма является частичная
    укладка <var>G</var>&#8242; планарного графа <var>G</var> такая, что
    |&#915;(<var>S</var>)|&nbsp;=&nbsp;2 для любого сегмента <var>S</var>
    относительно <var>G</var>&#8242;,
    то <var>A</var>(<var>G</var>&#8242;)&nbsp;— двудольный граф.
</p>
<p>
    <strong>Доказательство.</strong>
    Пусть <var>A</var>(<var>G</var>&#8242;)&nbsp;— не двудольный, тогда
    по теореме Кенига в нем есть цикл нечетной длины. По Лемме 2 все вершины
    этого цикла вмещаются ровно двумя гранями. Поскольку цикл нечетный, мы не
    сможем уложить эти сегменты в две грани. Противоречие. Лемма доказана.
</p>
<p>Ну вот, мы наконец-то подошли к тому, чтобы доказать нужную теорему.</p>

<h3>Теорема</h3>

<p>
    Гамма-алгоритм корректен, то есть, если <var>G</var>&nbsp;—
    планарный граф, то результатом каждого шага гамма-алгоритма является
    частичная укладка <var>G</var>&#8242;.
</p>
<p>
    <strong>Доказательство.</strong>
    Докажем индукцией по числу шагов.
</p>
<p>
    База индукции очевидна: результат инициализации есть плоская укладка, так
    как уложенный цикл будет в любой укладке.
</p>
<p>
    Пусть граф <var>G</var>&#8242;<sub><var>k</var>&#8722;1</sub>, полученный
    на (<var>k</var>&#8722;1)-м шаге, является частичной укладкой. На текущем
    шаге к нему присоединится цепь <var>L</var>:
    <var>G</var>&#8242;<sub><var>k</var></sub>&nbsp;=&nbsp;<var>G</var>&#8242;<sub><var>k</var>&#8722;1</sub>&nbsp;&#8746;&nbsp;<var>L</var>.
    Докажем, что граф <var>G</var>&#8242;<sub><var>k</var></sub>&nbsp;—
    тоже частичная укладка. Среди сегментов на текущем шаге нет такого
    <var>S</var>, что |&#915;(<var>S</var>)|&nbsp;=&nbsp;0, иначе
    <var>G</var>&#8242;<sub><var>k</var>&#8722;1</sub> не был бы частичной
    укладкой. Значит, либо существует <var>S</var> такой, что
    |&#915;(<var>S</var>)|&nbsp;=&nbsp;1, либо все <var>S</var> таковы, что
    |&#915;(<var>S</var>)|&nbsp;=&nbsp;2.
</p>    
<p>
    Первый случай означает, что укладка <var>S</var> в &#915; неизбежна, так
    что граф <var>G</var>&#8242;<sub><var>k</var></sub> после добавления цепи
    из <var>S</var> останется частичной укладкой. Во втором случае построим
    граф <var>A</var>(<var>G</var>&#8242;<sub><var>k</var>&#8722;1</sub>),
    по Лемме 3 он двудольный. Возьмем его связную компоненту
    <var>A</var>&#8242;, этот граф тоже двудольный. Для сегментов
    из <var>A</var>&#8242; имеются ровно две грани &#915;<sub>1</sub>
    и &#915;<sub>2</sub>, вмещающие их. Раскидаем сегменты
    <var>A</var>&#8242; по граням &#915;<sub>1</sub> и &#915;<sub>2</sub>
    попеременно. Это необходимо сделать в каждой частичной укладке,
    следовательно получена частичная укладка.
</p>
<p>
    Фактически, основой последней части доказательства было, что если граф
    <var>A</var>(<var>G</var>&#8242;<sub><var>k</var>&#8722;1</sub>)&nbsp;—
    двудольный, то после удаления части ребер и вершин граф
    <var>A</var>(<var>G</var>&#8242;<sub><var>k</var></sub>) тоже двудольный.
    Таким образом, в результате каждой итерации для планарного графа частичная
    укладка увеличивается, в конце мы получим плоскую укладку.
</p>


<h2>Литература</h2>

<ol>
<li>
    Бондарев&nbsp;В.М., Рублинецкий&nbsp;В.И., Качко&nbsp;Е.Г.
    <a href="http://rain.ifmo.ru/cat/view.php/books/rublin-1997">Основы программирования.</a>&nbsp;—
    Харьков: Фолио; Ростов н/Д: Феникс, 1997.
</li>
<li>
    Емеличев&nbsp;Р.И., Мельников&nbsp;О.И., Сарванов&nbsp;В.И.,
    Тышкевич&nbsp;Р.И. Лекции по теории графов.&nbsp;— М.: Наука, 1990.
</li>
</ol>

<p class="signature">Джанмухамедов Вадим</p>

<hr>
<div class="block">
<div class="block-head">
<b><a href="mailto:pogorskiy@mail.ru">Погорский Николай</a></b>
/ 2005-01-23 18:17:43</div>
<p>В описании гамма-алгоритма плоской укладки графа содержится грубая ошибка &lt;...&gt; что в дальнейшем может привести к неправильному выводу о непланарности графа.</p>
<p class="red">Спасибо за внимательное изучение материалов сайта!  Статья исправлена.</p></div>
<div class="block">
<div class="block-head">
<b><a href="mailto:fillip2001@mail.ru">Аналитик Штыков Ф.Г.</a></b>
/ 2005-04-28 12:36:11</div>
<p>Вот какой бред написан в статье:</p>
<p>Плоский граф — это граф, нарисованный таким образом, что его ребра не пересекаются. Говорят, что граф допускает плоскую укладку, если его можно нарисовать как плоский. Также плоские графы называют планарными.</p>
<p>А вот это уже не бред:</p>
<p>Планарный - это граф, который изоморфен плоскому.<br>
Планарный граф это граф с пересечениями, но допускающий его плоскую укладку.</p>
<p>Нет дороги иди в педагоги!</p>
<p class="red">Терминологическое замечание правильное, и передано автору для внесения исправления.</p>
<p class="red">На обдумывание вашей рекомендации относительно возможного трудоустройства у него есть еще несколько лет до окончания цикла дневного обучения.</p></div>
<form action="http://rain.ifmo.ru/cat/comment.php/theory/graph-coloring-layout/layout-2004" method="post">
<table cellspacing="10">
<tbody><tr>
<td><b>Ваше имя</b></td>
<td><input type="text" name="name" size="40" maxlength="64" class="text"></td>
</tr>
<tr>
<td><b>Email</b></td>
<td><input type="text" name="email" size="40" maxlength="64" class="text"></td>
</tr>
<tr>
<td><b>Текущий день недели</b></td>
<td><input type="text" name="today" size="40" maxlength="64" class="text"> (строчными буквами)</td>
</tr>
<tr>
<td style="vertical-align:top"><b>Комментарий</b></td>
<td><textarea name="message" class="text" rows="10" cols="60"></textarea></td>
</tr>
<tr>
<td>&nbsp;</td>
<td><input type="submit" value="Отправить" class="button"></td>
</tr>
</tbody></table>
</form>

</td>
</tr>
</tbody></table>

<div id="foot">
Опубликовано 2004-06-07 14:47:32,
последнее обновление 2007-07-17 13:45:58
</div>



</body></html>